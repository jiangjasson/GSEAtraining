<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Topic 1-08: Generate gene sets for other organisms by mapping to orthologues • GSEAtraining</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Topic 1-08: Generate gene sets for other organisms by mapping to orthologues">
<meta property="og:description" content="GSEAtraining">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">GSEAtraining</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.99.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/topic1_00_format.html">Topic 1-00: Representation of gene sets in R</a>
    </li>
    <li>
      <a href="../articles/topic1_01_GO.html">Topic 1-01: Get GO gene sets</a>
    </li>
    <li>
      <a href="../articles/topic1_02_kegg.html">Topic 1-02: Get pathways from KEGG</a>
    </li>
    <li>
      <a href="../articles/topic1_03_msigdbr.html">Topic 1-03: Get pathways from MSigDB</a>
    </li>
    <li>
      <a href="../articles/topic1_04_Reactome.html">Topic 1-04: Get pathways from Reactome</a>
    </li>
    <li>
      <a href="../articles/topic1_05_BioCarta.html">Topic 1-05: Get pathways from BioCarta</a>
    </li>
    <li>
      <a href="../articles/topic1_06_UniProtKeywords.html">Topic 1-06: Get gene sets from UniProt Keywords</a>
    </li>
    <li>
      <a href="../articles/topic1_07_more_gene_sets.html">Topic 1-07: Get GO/KEGG gene sets for other organisms</a>
    </li>
    <li>
      <a href="../articles/topic1_08_ortholog.html">Topic 1-08: Generate gene sets for other organisms by mapping to orthologues</a>
    </li>
    <li>
      <a href="../articles/topic1_09_gene_id.html">Topic 1-09: Gene ID conversion</a>
    </li>
    <li>
      <a href="../articles/topic2_01_ora_single_gene_set.html">Topic 2-01: ORA on a single gene set</a>
    </li>
    <li>
      <a href="../articles/topic2_02_implement_ora.html">Topic 2-02: Implement ORA from stratch</a>
    </li>
    <li>
      <a href="../articles/topic2_03_clusterProfiler_ora.html">Topic 2-03: Use clusterProfiler for ORA</a>
    </li>
    <li>
      <a href="../articles/topic2_04_implement_gsea.html">Topic 2-04: Implement GSEA from scratch</a>
    </li>
    <li>
      <a href="../articles/topic2_05_clusterProfiler_gsea.html">Topic 2-05: Use clusterProfiler for GSEA</a>
    </li>
    <li>
      <a href="../articles/topic2_06_compare_ORA_GSEA.html">Topic 2-06: Compare ORA and GSEA</a>
    </li>
    <li>
      <a href="../articles/topic3_01_online_GREAT.html">Topic 3-01: Online GREAT analysis</a>
    </li>
    <li>
      <a href="../articles/topic3_02_local_GREAT.html">Topic 3-02: Local GREAT analysis</a>
    </li>
    <li>
      <a href="../articles/topic3_03_goseq.html">Topic 3-03: GOseq</a>
    </li>
    <li>
      <a href="../articles/topic4_01_CePa.html">Topic 4-01: CePa</a>
    </li>
    <li>
      <a href="../articles/topic4_02_GSVA.html">Topic 4-02: GSVA</a>
    </li>
    <li>
      <a href="../articles/topic5_01_similarity.html">Topic 5-01: Similarities of terms</a>
    </li>
    <li>
      <a href="../articles/topic5_02_simplifyEnrichment.html">Topic 5-02: simplifyEnrichment</a>
    </li>
    <li>
      <a href="../articles/topic6_01_visualization.html">Topic 6-01: Visualization</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/jokergoo/GSEAtraining/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Topic 1-08: Generate gene sets for other organisms by mapping to orthologues</h1>
                        <h4 data-toc-skip class="author">Zuguang Gu <a href="mailto:z.gu@dkfz.de" class="email">z.gu@dkfz.de</a>
</h4>
            
            <h4 data-toc-skip class="date">2024-01-25</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/jokergoo/GSEAtraining/blob/HEAD/vignettes/topic1_08_ortholog.Rmd" class="external-link"><code>vignettes/topic1_08_ortholog.Rmd</code></a></small>
      <div class="hidden name"><code>topic1_08_ortholog.Rmd</code></div>

    </div>

    
    
<p>In the Bioconductor ecosystem, there are already a huge number of gene set resources for a large number of organisms. However, there can still be cases where a poor-studied organism does not have a well-annotated gene set resource. Human, of course, is the most studied organism and it has the richest annotation resources. For other organisms, we can built similar gene sets by mapping to orthologues to human genes.</p>
<p>The hallmark gene sets is a useful resource for exploring the biological functions. But natively, MSigDB only provides data for human and mouse, but still a large number of other organisms are missing. In the following part of this section, I will demonstrate how to construct hallmark gene sets for the great panda.</p>
<div class="section level2">
<h2 id="the-orthology-eg-db-package">The Orthology.eg.db package<a class="anchor" aria-label="anchor" href="#the-orthology-eg-db-package"></a>
</h2>
<p>Let me first demonstrate how to obtain the mapping from human genes to panda genes. In Biocoductor, there is a standard package <strong>Orthology.eg.db</strong> which provides orthologue mappings for hundreds of organisms. Let’s first load the package.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">Orthology.eg.db</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Loading required package: AnnotationDbi</span></span></code></pre>
<pre><code><span><span class="co">## Loading required package: stats4</span></span></code></pre>
<pre><code><span><span class="co">## Loading required package: BiocGenerics</span></span></code></pre>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Attaching package: 'BiocGenerics'</span></span></code></pre>
<pre><code><span><span class="co">## The following objects are masked from 'package:stats':</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     IQR, mad, sd, var, xtabs</span></span></code></pre>
<pre><code><span><span class="co">## The following objects are masked from 'package:base':</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     Filter, Find, Map, Position, Reduce, anyDuplicated, aperm, append,</span></span>
<span><span class="co">##     as.data.frame, basename, cbind, colnames, dirname, do.call,</span></span>
<span><span class="co">##     duplicated, eval, evalq, get, grep, grepl, intersect, is.unsorted,</span></span>
<span><span class="co">##     lapply, mapply, match, mget, order, paste, pmax, pmax.int, pmin,</span></span>
<span><span class="co">##     pmin.int, rank, rbind, rownames, sapply, setdiff, sort, table,</span></span>
<span><span class="co">##     tapply, union, unique, unsplit, which.max, which.min</span></span></code></pre>
<pre><code><span><span class="co">## Loading required package: Biobase</span></span></code></pre>
<pre><code><span><span class="co">## Welcome to Bioconductor</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     Vignettes contain introductory material; view with</span></span>
<span><span class="co">##     'browseVignettes()'. To cite Bioconductor, see</span></span>
<span><span class="co">##     'citation("Biobase")', and for packages 'citation("pkgname")'.</span></span></code></pre>
<pre><code><span><span class="co">## Loading required package: IRanges</span></span></code></pre>
<pre><code><span><span class="co">## Loading required package: S4Vectors</span></span></code></pre>
<pre><code><span><span class="co">## Warning: package 'S4Vectors' was built under R version 4.3.2</span></span></code></pre>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Attaching package: 'S4Vectors'</span></span></code></pre>
<pre><code><span><span class="co">## The following object is masked from 'package:utils':</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     findMatches</span></span></code></pre>
<pre><code><span><span class="co">## The following objects are masked from 'package:base':</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     I, expand.grid, unname</span></span></code></pre>
<pre><code><span><span class="co">## </span></span></code></pre>
<p>Similarly, there is a database object <code>Orthology.eg.db</code> which has the same name as the package.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Orthology.eg.db</span></span></code></pre></div>
<pre><code><span><span class="co">## OrthologyDb object:</span></span>
<span><span class="co">## | Db type: OrthologyDb</span></span>
<span><span class="co">## | Supporting package: AnnotationDbi</span></span>
<span><span class="co">## | DBSCHEMA: ORTHOLOGY_DB</span></span>
<span><span class="co">## | EGSOURCEDATE: 2023-Mar05</span></span>
<span><span class="co">## | EGSOURCENAME: Entrez Gene</span></span>
<span><span class="co">## | EGSOURCEURL: ftp://ftp.ncbi.nlm.nih.gov/gene/DATA</span></span>
<span><span class="co">## | DBSCHEMAVERSION: 2.1</span></span></code></pre>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Please see: help('select') for usage information</span></span></code></pre>
<p>The orthology database can be thought as a table where columns are different organisms, and rows are groups of orthologues genes. All supported organisms can be obtained by the function <code><a href="https://rdrr.io/pkg/AnnotationDbi/man/AnnotationDb-class.html" class="external-link">columns()</a></code>.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cl</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/AnnotationDbi/man/AnnotationDb-class.html" class="external-link">columns</a></span><span class="op">(</span><span class="va">Orthology.eg.db</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">cl</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 508</span></span></code></pre>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">cl</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "Acanthisitta.chloris"        "Acanthochromis.polyacanthus"</span></span>
<span><span class="co">## [3] "Acanthopagrus.latus"         "Accipiter.gentilis"         </span></span>
<span><span class="co">## [5] "Acinonyx.jubatus"            "Acipenser.ruthenus"</span></span></code></pre>
<p>The column names correspond to organism’s Latin names, separated by a dot character. Remember to use the <code><a href="https://rdrr.io/pkg/AnnotationDbi/man/AnnotationDb-class.html" class="external-link">select()</a></code>interface, we also need to check which column can be used for the keys. In <code>Orthology.eg.db</code>, all columns can be used as key columns, which means, we can map between any two organisms We can valiadte it by:</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">kt</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/AnnotationDbi/man/AnnotationDb-class.html" class="external-link">keytypes</a></span><span class="op">(</span><span class="va">Orthology.eg.db</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/identical.html" class="external-link">identical</a></span><span class="op">(</span><span class="va">cl</span>, <span class="va">kt</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] TRUE</span></span></code></pre>
<p>We check whether the panda organism is supported in <code>Orthology.eg.db</code> by searching its Latin name <code>"Ailuropoda melanoleuca"</code>.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">kt</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/grep.html" class="external-link">grep</a></span><span class="op">(</span><span class="st">"Ailuropoda"</span>, <span class="va">kt</span>, ignore.case <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "Ailuropoda.melanoleuca"</span></span></code></pre>
<p>Yes, it is supported. For converting between two types of IDs, I will first create a global mapping vector, where human genes are the names of the vector and panda genes are the values.</p>
<p>I first extract all the human genes, which will be the primary keys for the orthology mapping. Remember the value for keytype argument should be a valid value in <code>keytypes(Orthology.eg.db)</code>.</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">keys</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/AnnotationDbi/man/AnnotationDb-class.html" class="external-link">keys</a></span><span class="op">(</span><span class="va">Orthology.eg.db</span>, keytype <span class="op">=</span> <span class="st">"Homo.sapiens"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">keys</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1]  1  2  9 10 12 13</span></span></code></pre>
<p>The keys are in EntreZ ID type.</p>
<p>Now we can apply <code><a href="https://rdrr.io/pkg/AnnotationDbi/man/AnnotationDb-class.html" class="external-link">select()</a></code> function on the <code>Orthology.eg.db</code> database object and generate the mapping.</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">map_df</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/AnnotationDbi/man/AnnotationDb-class.html" class="external-link">select</a></span><span class="op">(</span><span class="va">Orthology.eg.db</span>, <span class="va">keys</span>, </span>
<span>    columns <span class="op">=</span> <span class="st">"Ailuropoda.melanoleuca"</span>, keytype <span class="op">=</span> <span class="st">"Homo.sapiens"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">map_df</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   Homo.sapiens Ailuropoda.melanoleuca</span></span>
<span><span class="co">## 1            1              100482878</span></span>
<span><span class="co">## 2            2                     NA</span></span>
<span><span class="co">## 3            9                     NA</span></span>
<span><span class="co">## 4           10                     NA</span></span>
<span><span class="co">## 5           12              100481925</span></span>
<span><span class="co">## 6           13              100468737</span></span></code></pre>
<p>Now <code>map_df</code> is a two-column data frame where the first column includes the genes for human and the second column includes genes for panda. If there is no orthologue mapping, the corresponding value for panda is <code>NA</code>. We see the gene IDs are integers, but what is exactly the ID type of it? We have to go through the documentation of the Orthology.eg.db package, it tells the internal IDs are Entrez IDs.</p>
<style>
blockquote {
    padding: 10px 20px;
    margin: 0 0 20px;
    font-size: 14px;
    background: #eee;
    border-left: 6px #CCCCCC solid;
}
</style>
<blockquote>
<p><strong>Danger zone:</strong> Entrez IDs should not be saved as integers!</p>
</blockquote>
<p>Before we move on, we have to double check how Entrez IDs are saved in <code>map_df</code>.</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">map_df</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "integer"</span></span></code></pre>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">map_df</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "integer"</span></span></code></pre>
<p>Unfortunately they are in integer mode, we have to convert them to characters.</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">map_df</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">map_df</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">map_df</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">map_df</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<p>Now we can safely constrcut the mapping vector where human genes are names and panda genes are values.</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">map_vec</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/structure.html" class="external-link">structure</a></span><span class="op">(</span><span class="va">map_df</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span>, names <span class="op">=</span> <span class="va">map_df</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co"># or we can do it in two lines</span></span>
<span><span class="va">map_vec</span> <span class="op">=</span> <span class="va">map_df</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">map_vec</span><span class="op">)</span> <span class="op">=</span> <span class="va">map_df</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">map_vec</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##           1           2           9          10          12          13 </span></span>
<span><span class="co">## "100482878"          NA          NA          NA "100481925" "100468737"</span></span></code></pre>
<p>We have the mappings from human to panda, now we can construct the hallmark gene sets for panda. First let’s obtain the hallmark gene sets for human. The <code><a href="../reference/msigdb.html">get_msigdb()</a></code> function is from the <strong>GSEAtraining</strong> package.</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/jokergoo/GSEAtraining" class="external-link">GSEAtraining</a></span><span class="op">)</span></span>
<span><span class="va">gs_human</span> <span class="op">=</span> <span class="fu"><a href="../reference/msigdb.html">get_msigdb</a></span><span class="op">(</span>version <span class="op">=</span> <span class="st">"2023.2.Hs"</span>, collection <span class="op">=</span> <span class="st">"h.all"</span><span class="op">)</span></span></code></pre></div>
<p>Next we perform the conversion by providing the human genes are character indicies. Note if the human gene is not mapped to panda gene, the corresponding value will be <code>NA</code>, which we need to remove it. Using the <code><a href="https://rdrr.io/r/base/unname.html" class="external-link">unname()</a></code> function is optional. The reason is <code>x2</code> is constructed from <code>map_vec</code> which has names attached. Here I removed the name attributes of <code>x2</code> to make <code>gs_panda</code> easy to read.</p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gs_panda</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">gs_human</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">x2</span> <span class="op">=</span> <span class="va">map_vec</span><span class="op">[</span><span class="va">x</span><span class="op">]</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/unname.html" class="external-link">unname</a></span><span class="op">(</span><span class="va">x2</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">x2</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span></code></pre></div>
<p>And finally to remove empty gene sets. Now <code>gs_panda</code> contains hallmark gene sets for panda.</p>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gs_panda</span> <span class="op">=</span> <span class="va">gs_panda</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">gs_panda</span>, <span class="va">length</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">]</span></span>
<span><span class="va">gs_panda</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">## $HALLMARK_ADIPOGENESIS</span></span>
<span><span class="co">##   [1] "100483394" "100467221" "100476344" "100467341" "100480578" "100483719"</span></span>
<span><span class="co">##   [7] "100467494" "100479955" "100471606" "100476922" "109488363" "100481319"</span></span>
<span><span class="co">##  [13] "100473600" "100476840" "100471854" "100475159" "100483231" "100478103"</span></span>
<span><span class="co">##  [19] "100464955" "100475013" "100470064" "100477661" "100475955" "100478341"</span></span>
<span><span class="co">##  [25] "100467218" "100484596" "100478407" "100473683" "100484116" "100465691"</span></span>
<span><span class="co">##  [31] "100480054" "100472549" "100473949" "100470190" "100472500" "100481463"</span></span>
<span><span class="co">##  [37] "100483649" "100463982" "100470950" "100479936" "100464675" "100483793"</span></span>
<span><span class="co">##  [43] "100482840" "100471225" "100475944" "100478752" "100467925" "100478122"</span></span>
<span><span class="co">##  [49] "100471241" "100479884" "100475526" "100475627" "100465139" "100464724"</span></span>
<span><span class="co">##  [55] "100463800" "100480854" "100473628" "100479670" "100476910" "100481266"</span></span>
<span><span class="co">##  [61] "100479095" "100467495" "100471989" "100477433" "100479347" "100472325"</span></span>
<span><span class="co">##  [67] "100474044" "100478586" "100473571" "100471547" "100467523" "100477228"</span></span>
<span><span class="co">##  [73] "100465578" "100464202" "100483572" "100473687" "100469740" "100475353"</span></span>
<span><span class="co">##  [79] "100470081" "100468497" "100470379" "100468331" "100477654" "100479358"</span></span>
<span><span class="co">##  [85] "100471171" "100468728" "100483093" "100482626" "100471953" "100473120"</span></span>
<span><span class="co">##  [91] "100484549" "100466232" "100480395" "100463910" "100480163" "100482520"</span></span>
<span><span class="co">##  [97] "100483295" "100473768" "100470553" "100475280" "100468697" "100478658"</span></span>
<span><span class="co">## [103] "100470630" "100472419" "100474605" "100463863" "100479605" "100472770"</span></span>
<span><span class="co">## [109] "100482804" "105238479" "100484030" "100464608" "100464508" "100465272"</span></span>
<span><span class="co">## [115] "100483500" "100475941" "100472911" "100477762" "100474896" "100478484"</span></span>
<span><span class="co">## [121] "100481263" "100472251" "100469925" "100477501" "100477724" "100480436"</span></span>
<span><span class="co">## [127] "100465245" "105241326" "100469480" "100471478" "100479273" "100464074"</span></span>
<span><span class="co">## [133] "100479861" "100475139" "100483714" "100467763" "100478217" "100474540"</span></span>
<span><span class="co">## [139] "100465011" "100482938" "100467132" "100465583" "100478555" "100466891"</span></span>
<span><span class="co">## [145] "100470302" "100480537" "100482490" "100465465" "100471603" "100466261"</span></span>
<span><span class="co">## [151] "105238785" "100476977" "100479709" "100483477" "100472435" "100479054"</span></span>
<span><span class="co">## [157] "100476123" "100473802" "100484067" "100469567" "100473290" "100480530"</span></span>
<span><span class="co">## [163] "100464327" "100471124" "100467163" "100471492" "100475614" "100466386"</span></span>
<span><span class="co">## [169] "100465252" "100473253" "100477509" "100470895" "100465294" "100476369"</span></span>
<span><span class="co">## [175] "100466768" "100479654" "100464478" "100480186" "100484661" "100484543"</span></span>
<span><span class="co">## [181] "100476136" "100484798" "100468480" "100472838" "100477702" "100473348"</span></span>
<span><span class="co">## [187] "100484841" "100479434" "100478686" "100483229" "100465735" "100464004"</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $HALLMARK_ALLOGRAFT_REJECTION</span></span>
<span><span class="co">##   [1] "100474675" "100477383" "100465106" "100482126" "100472026" "100465793"</span></span>
<span><span class="co">##   [7] "100475168" "100470489" "100465389" "100473529" "100478429" "100480891"</span></span>
<span><span class="co">##  [13] "100474163" "100477480" "100466311" "100481549" "100470232" "100463753"</span></span>
<span><span class="co">##  [19] "100471517" "100479467" "100484065" "100478428" "100484298" "100477902"</span></span>
<span><span class="co">##  [25] "100484718" "100482462" "100484468" "100482689" "100476345" "100467917"</span></span>
<span><span class="co">##  [31] "100480521" "100475502" "100475218" "100471626" "100480227" "100483382"</span></span>
<span><span class="co">##  [37] "100483271" "100484695" "100472499" "100481747" "100467898" "100467411"</span></span>
<span><span class="co">##  [43] "100472520" "100483259" "105234669" "100469185" "100475682" "100483900"</span></span>
<span><span class="co">##  [49] "100478672" "100484183" "105235090" "100478049" "100467045" "100467465"</span></span>
<span><span class="co">##  [55] "100465360" "100473811" "100472504" "100464489" "100469300" "100472871"</span></span>
<span><span class="co">##  [61] "105240499" "100473767" "100468235" "100467541" "100467791" "100464552"</span></span>
<span><span class="co">##  [67] "100466565" "100481771" "100475920" "100481622" "100476014" "100479773"</span></span>
<span><span class="co">##  [73] "100468902" "100474777" "100464636" "100477284" "100464393" "100478290"</span></span>
<span><span class="co">##  [79] "105241843" "100476475" "100480624" "100482679" "100462659" "100473768"</span></span>
<span><span class="co">##  [85] "100481672" "100463682" "100471679" "100481671" "100478943" "100470471"</span></span>
<span><span class="co">##  [91] "100477772" "100474774" "100474520" "100484790" "100467740" "100484109"</span></span>
<span><span class="co">##  [97] "100476941" "100480874" "100480862" "100475725" "100466247" "100478292"</span></span>
<span><span class="co">## [103] "100468126" "100482473" "100476095" "100481194" "105237562" "100463717"</span></span>
<span><span class="co">## [109] "100484001" "100481889" "100474086" "100469809" "100464009" "100484264"</span></span>
<span><span class="co">## [115] "100475688" "100481360" "105234734" "100471453" "100477981" "100463836"</span></span>
<span><span class="co">## [121] "100483416" "100467628" "100479649" "100479606" "100466506" "100470792"</span></span>
<span><span class="co">## [127] "100482608" "100475429" "100482185" "100476115" "100468228" "100471786"</span></span>
<span><span class="co">## [133] "100476162" "100468792" "100470060" "100464343" "100473675" "100478007"</span></span>
<span><span class="co">## [139] "100484719" "100468826" "100473539" "100474611" "100479579" "100480506"</span></span>
<span><span class="co">## [145] "100478926" "100479482" "100466931" "100471128" "100484671" "100464779"</span></span>
<span><span class="co">## [151] "100476391" "100480183" "100469980" "100476314" "100476695" "100481666"</span></span>
<span><span class="co">## [157] "100484430" "100474026" "100471596" "100464886" "100478040" "100484836"</span></span>
<span><span class="co">## [163] "100470703" "100463584" "100465131" "100476205" "100472707" "100465129"</span></span>
<span><span class="co">## [169] "100468855" "100472456" "100471563" "100473222" "100474087" "100467951"</span></span>
<span><span class="co">## [175] "100479205" "100476065" "100472174" "100479480" "100473238"</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="practice">Practice<a class="anchor" aria-label="anchor" href="#practice"></a>
</h2>
<div class="section level3 tabset">
<h3 class="tabset" id="section"></h3>
<div class="section level4">
<h4 id="practice-1">Practice 1<a class="anchor" aria-label="anchor" href="#practice-1"></a>
</h4>
<p>Construct hallmark gene sets for dolphin (latin name: Tursiops truncatus)</p>
</div>
<div class="section level4">
<h4 id="solution">Solution<a class="anchor" aria-label="anchor" href="#solution"></a>
</h4>
<p>First check whether it is supported in <strong>Orthology.eg.db</strong>.</p>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">kt</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/grep.html" class="external-link">grep</a></span><span class="op">(</span><span class="st">"Tursiops"</span>, <span class="va">kt</span>, ignore.case <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "Tursiops.truncatus"</span></span></code></pre>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">map_df</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/AnnotationDbi/man/AnnotationDb-class.html" class="external-link">select</a></span><span class="op">(</span><span class="va">Orthology.eg.db</span>, <span class="va">keys</span>, </span>
<span>    columns <span class="op">=</span> <span class="st">"Tursiops.truncatus"</span>, keytype <span class="op">=</span> <span class="st">"Homo.sapiens"</span><span class="op">)</span></span>
<span><span class="va">map_df</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">map_df</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">map_df</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">map_df</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="va">map_vec</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/structure.html" class="external-link">structure</a></span><span class="op">(</span><span class="va">map_df</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span>, names <span class="op">=</span> <span class="va">map_df</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="va">gs_dolphin</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">gs_human</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">x2</span> <span class="op">=</span> <span class="va">map_vec</span><span class="op">[</span><span class="va">x</span><span class="op">]</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/unname.html" class="external-link">unname</a></span><span class="op">(</span><span class="va">x2</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">x2</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span><span class="va">gs_dolphin</span> <span class="op">=</span> <span class="va">gs_dolphin</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">gs_dolphin</span>, <span class="va">length</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">]</span></span>
<span><span class="va">gs_dolphin</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">## $HALLMARK_ADIPOGENESIS</span></span>
<span><span class="co">##   [1] "101324261" "101331892" "101333071" "101321535" "101339921" "117307625"</span></span>
<span><span class="co">##   [7] "101333508" "101338166" "101338715" "101337662" "101337434" "101324186"</span></span>
<span><span class="co">##  [13] "101339119" "101315601" "101333510" "101324917" "101318798" "117308060"</span></span>
<span><span class="co">##  [19] "101331188" "117311769" "101336246" "117308978" "101334408" "117313583"</span></span>
<span><span class="co">##  [25] "101337204" "101322713" "101331966" "101320909" "117309210" "101319712"</span></span>
<span><span class="co">##  [31] "101317605" "101338084" "101331217" "101333092" "101318581" "101336723"</span></span>
<span><span class="co">##  [37] "101331721" "101336369" "101321426" "101320458" "101327681" "101328124"</span></span>
<span><span class="co">##  [43] "101329295" "101322991" "101323341" "101320029" "101333781" "101325542"</span></span>
<span><span class="co">##  [49] "101332916" "101318829" "101338610" "101335861" "101331598" "101326966"</span></span>
<span><span class="co">##  [55] "117308749" "101325838" "101321389" "101332530" "117308690" "101332074"</span></span>
<span><span class="co">##  [61] "101323928" "101330785" "101334301" "101321942" "101335654" "101338928"</span></span>
<span><span class="co">##  [67] "101335930" "101334607" "101321860" "101334218" "101327108" "101317181"</span></span>
<span><span class="co">##  [73] "101331943" "101330375" "101321280" "101318459" "117311150" "101319836"</span></span>
<span><span class="co">##  [79] "101338608" "101324500" "101340172" "101323442" "101337802" "101339046"</span></span>
<span><span class="co">##  [85] "101330605" "101335592" "101338890" "117311850" "101338602" "101326990"</span></span>
<span><span class="co">##  [91] "101316447" "101334850" "101328969" "101321334" "101324223" "101327594"</span></span>
<span><span class="co">##  [97] "101327173" "117314225" "101332137" "101332387" "101326295" "101331166"</span></span>
<span><span class="co">## [103] "117313539" "101335303" "117309227" "101324084" "101337343" "101329342"</span></span>
<span><span class="co">## [109] "101318463" "101337284" "101336162" "101326342" "101337956" "101336374"</span></span>
<span><span class="co">## [115] "101332376" "101329906" "101321797" "101329039" "101322039" "101319682"</span></span>
<span><span class="co">## [121] "101321364" "101329593" "101330807" "117311742" "101319163" "101318892"</span></span>
<span><span class="co">## [127] "101328287" "101318749" "101322527" "101319551" "117309367" "101332305"</span></span>
<span><span class="co">## [133] "101325875" "101339425" "101337346" "101331169" "101324967" "117314139"</span></span>
<span><span class="co">## [139] "101327440" "101332835" "101326018" "101322234" "101334941" "101316073"</span></span>
<span><span class="co">## [145] "101326873" "101329793" "101335522" "101332488" "101333678" "117311841"</span></span>
<span><span class="co">## [151] "117311779" "101333929" "101337766" "101333557" "101335961" "101316913"</span></span>
<span><span class="co">## [157] "101337558" "101323493" "101327629" "101332633" "101315682" "101329811"</span></span>
<span><span class="co">## [163] "101336956" "101329389" "101333152" "101327260" "101331047" "101336065"</span></span>
<span><span class="co">## [169] "101322982" "101337059" "101337718" "101338733" "101331474" "101333013"</span></span>
<span><span class="co">## [175] "101320464" "101332754" "101316418" "101330490" "101327745" "101337563"</span></span>
<span><span class="co">## [181] "101318801" "101331812" "101328440" "101326471" "101316129" "101333717"</span></span>
<span><span class="co">## [187] "101322601" "101318867" "117311820" "101328687" "101316570" "109549330"</span></span>
<span><span class="co">## [193] "117308030"</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $HALLMARK_ALLOGRAFT_REJECTION</span></span>
<span><span class="co">##   [1] "101316006" "101322461" "101325827" "117308055" "101337652" "101334655"</span></span>
<span><span class="co">##   [7] "101320863" "117311091" "101338911" "101335912" "101332324" "101319443"</span></span>
<span><span class="co">##  [13] "117313830" "117307933" "101332498" "117312582" "101323189" "101337792"</span></span>
<span><span class="co">##  [19] "109552529" "101332929" "101318861" "101337386" "101324372" "101318685"</span></span>
<span><span class="co">##  [25] "101320520" "101318977" "101319269" "101319080" "101330521" "101337561"</span></span>
<span><span class="co">##  [31] "101338006" "101334285" "101322889" "117308993" "101316111" "101328068"</span></span>
<span><span class="co">##  [37] "101325833" "109551019" "101319896" "117312596" "117310434" "101328686"</span></span>
<span><span class="co">##  [43] "101325006" "101318184" "101338838" "101333230" "101331685" "101329574"</span></span>
<span><span class="co">##  [49] "101317829" "101338156" "101330476" "101325906" "101324454" "101325246"</span></span>
<span><span class="co">##  [55] "101321725" "101337526" "101317832" "101324567" "101316077" "101317421"</span></span>
<span><span class="co">##  [61] "101315588" "101321590" "101336517" "101336680" "101316660" "101336991"</span></span>
<span><span class="co">##  [67] "101315855" "101317113" "101337909" "101338980" "101324613" "101339595"</span></span>
<span><span class="co">##  [73] "101324632" "101335518" "101335803" "117313882" "101336672" "101336089"</span></span>
<span><span class="co">##  [79] "117311758" "101315573" "101330507" "101337436" "101327594" "101336209"</span></span>
<span><span class="co">##  [85] "101330540" "101327715" "101330184" "117309240" "101325702" "101338510"</span></span>
<span><span class="co">##  [91] "101339814" "101338603" "101319832" "101333811" "101334331" "101331381"</span></span>
<span><span class="co">##  [97] "101318809" "101325136" "101324556" "101323898" "101330858" "117310158"</span></span>
<span><span class="co">## [103] "101338293" "101316092" "101329901" "101322100" "101331699" "101316054"</span></span>
<span><span class="co">## [109] "101318917" "101335564" "117313261" "101337877" "101321073" "101324233"</span></span>
<span><span class="co">## [115] "101323565" "101334791" "117314288" "101333191" "101317602" "101318472"</span></span>
<span><span class="co">## [121] "117313815" "109551474" "101339042" "101319418" "101320162" "101321493"</span></span>
<span><span class="co">## [127] "101329372" "101330701" "101316407" "101340051" "101338757" "101327068"</span></span>
<span><span class="co">## [133] "101318929" "101338302" "101338542" "101335049" "101331937" "117308498"</span></span>
<span><span class="co">## [139] "101318466" "101328304" "117309120" "101323322" "101334480" "101322158"</span></span>
<span><span class="co">## [145] "101332255" "101329453" "117308176" "101336040" "117308963" "101323062"</span></span>
<span><span class="co">## [151] "101339204" "101329800" "101328107" "101331087" "101321759" "101329195"</span></span>
<span><span class="co">## [157] "101326362" "101326807" "101322203" "101328796" "101335034" "101325082"</span></span>
<span><span class="co">## [163] "101327220" "101327029" "101315499" "117313367" "101334886" "101319774"</span></span>
<span><span class="co">## [169] "101338049" "101339193" "101320069" "101318178" "101334069" "101319749"</span></span>
<span><span class="co">## [175] "101334010" "101319013" "101326041" "101329104" "101326409" "101320092"</span></span></code></pre>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Zuguang Gu.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
